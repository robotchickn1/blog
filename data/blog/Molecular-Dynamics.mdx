---
title: My Molecular Dynamics Report
date: '2025-03-17'
tags: [Molecular Dynamics, Scilab, Computation]
draft: false
summary: Running a simulation of a gaseous system of 0.1 million atoms using Scilab and VMD.
---

## Aim

- Write an algorithm to carry out a simulation of a simple gaseous system using Scilab and VMD.

## Software

- [Scilab](https://www.scilab.org/) – for writing algorithms to create a gaseous system.
- [VMD (Visual Molecular Dynamics)](https://www.ks.uiuc.edu/Research/vmd/) – for visualization of the simulated gaseous system.
- [xmgrace](https://plasma-gate.weizmann.ac.il/Grace/) – for plotting data.

## Theory

### Molecular Dynamics

- Molecular dynamics (MD) is a computer simulation method for analyzing the physical movements of atoms and molecules, obtained by numerically solving Newton's equations of motion for a system of interacting particles.
- In MD, the nuclear motion of the constituent particles is assumed to obey the laws of classical mechanics. This is a very good approximation for a wide range of materials. Quantum effects start when we consider the translational or rotational motion of light atoms or molecules (He, H₂, D₂) or vibrational motion with a frequency such that:

$$
h\nu > k_B T
$$

### Periodic Boundary Conditions

Periodic Boundary Conditions (PBCs) simulate an _infinite system_ by wrapping particles that exit one side of the simulation box back into the opposite side. This eliminates edge effects and mimics bulk behavior in finite systems.

When a particle crosses a boundary:

$$
x_i \rightarrow x_i - L \cdot \text{round}\left(\dfrac{x_i}{L}\right)
$$

Where $L$ is the length of the simulation box.

### Minimum Image Convention

The Minimum Image Convention ensures that _each particle interacts only with the closest periodic image of other particles_.

For a cubic box with length $L$, the displacement vector between particles $i$ and $j$ is adjusted as:

$$
r_{ij} = r_i - r_j
$$

$$
r_{ij} = r_{ij} - L \cdot \text{round} \left( \dfrac{r_{ij}}{L} \right)
$$

### Potentials

- Molecular systems at atomic resolution are described in terms of **intramolecular** and **intermolecular** interactions.
- The _intra_ refers to all bonded interactions, and _inter_ refers to the non-bonded interactions.

#### Bonded Interactions

- Bonds
- Angles
- Dihedrals

#### Non-bonded Interactions

- Van der Waals interactions
- Electrostatic interactions

### Lennard-Jones Potential

The Lennard-Jones potential is a simple model that describes the essential features of interactions between simple atoms and molecules:  
Two interacting particles repel each other at very close distances, attract each other at moderate distances, and eventually stop interacting at infinite distances.

The general potential is given as:

$$
V_{LJ}(r) = \dfrac{A_n}{r^{n}} - \dfrac{B_m}{r^{m}}
$$

The most common form is the Lennard-Jones 12-6 potential:

$$
V_{LJ}(r) = 4\epsilon \left[ \left( \dfrac{\sigma}{r} \right)^{12} - \left( \dfrac{\sigma}{r} \right)^{6} \right]
$$

Where:

- The first term represents the repulsion (positive).
- The second term represents attraction (negative).

### Ergodic Hypothesis

The ergodic hypothesis states that, over long periods, the time average of a system's observable property equals the ensemble average of that property.  
In simpler terms, the time a system spends in a particular state is proportional to the number of microstates corresponding to that state.

---

## Algorithm

- **Initialization**

  - Positions and velocities of $N$ particles are randomly initiated inside a cubic box of length $L$.

- **Force Calculation**

  - Calculate forces between particles using the Minimum Image Convention.

- **Integrate Equations of Motion**

  - Integrate Newton’s equations of motion using the _Velocity-Verlet algorithm_.

- **MD Simulation**
  - Iterate over time steps, updating positions and velocities.

---

## Scilab Code

### Subroutine: Lattice Positions

We create a function called `lattice_pos`. It takes inputs: `index`, `Lx`, `Ly`, `Lz`, and `lattice_const`, and gives outputs: `a1`, `a2`, and `a3`.

- This function generates the lattice coordinates of `npart` particles.
- It starts by placing an atom at $-L/2$ to $L/2$ in $x$, $y$, and $z$ directions.
- `Lx`, `Ly`, and `Lz` are the dimensions of the system box.

### Subroutine: Initialization

We create a function called `initialization`.  
The outputs of this function are:

- Positions: `x`, `y`, and `z`
- Modified positions: `xm`, `ym`, and `zm`
- Velocities: `vx`, `vy`, and `vz`

The first loop:

- Generates initial positions for `npart` particles.
- Assigns random initial velocities in 3D.
- `rand() - 0.5` ensures velocities are bidirectional.

#### Scaling Factor

- Calculates total velocities and the sum of squared velocities to compute **average kinetic energy**.
- Adjusts velocities with the scaling factor `fs` so that the kinetic energy matches the desired temperature:

$$
\text{From Equipartition theorem:} \quad \langle KE \rangle = \dfrac{3}{2} k_B T
$$

- Modified positions `xm`, `ym`, and `zm` are used for _velocity-verlet integration_.

### Subroutine: Force Calculation

_Description placeholder_ (Code examples can follow this if you wish).

---
